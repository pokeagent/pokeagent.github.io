<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leaderboard - PokéAgent Challenge</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container header-container">
      <a href="index.html" class="logo">PokéAgent Challenge</a>
      <div class="mobile-toggle">
        <i class="fas fa-bars"></i>
      </div>
      <ul class="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="track1.html">Track 1</a></li>
        <li><a href="track2.html">Track 2</a></li>
        <li><a href="leaderboard.html">Leaderboard</a></li>
        <li><a href="rules.html">Rules</a></li>
        <li><a href="faq.html">FAQ</a></li>
      </ul>
    </div>
  </header>

  <!-- Leaderboard Section -->
  <section id="leaderboard" style="background-color: #f5f5f5; margin-top: 70px;">
    <div class="container">
      <h2 class="text-center mb-2">Leaderboard</h2>
      <p class="text-center mb-2">Current rankings for both competition tracks. Leaderboards are updated regularly throughout the competition.</p>

      <!-- Tab Navigation -->
      <!-- <div class="tab-container mb-2">
        <button class="tab-button active" onclick="switchTab('speedrunning')">Track 2: RPG Speedrunning</button>
        <button class="tab-button" onclick="switchTab('battling')">Track 1: Competitive Battling</button>
      </div> -->

      <!-- Battling Tab -->
      <div id="battling-tab" class="tab-content active">
        <h3>Track 1: Competitive Battling</h3>
        
        <!-- Format Selector -->
        <div class="format-selector mb-2">
          <label for="format-select">Select Format:</label>
          <select id="format-select" onchange="filterBattlingLeaderboard()">
            <option value="all">All Formats</option>
            <option value="gen1ou">Gen 1 OU</option>
            <option value="gen9ou">Gen 9 OU</option>
            <option value="gen9vgc2025regi">Gen 9 VGC 2025 Regulation</option>
          </select>
        </div>

        <div class="card">
          <div style="max-height: 300px; overflow-y: auto;">
            <table style="width: 100%; border-collapse: collapse;">
              <thead style="position: sticky; top: 0; background-color: white; z-index: 1;">
                <tr style="border-bottom: 2px solid #ddd; text-align: left;">
                  <th style="padding: 12px;">Rank</th>
                  <th style="padding: 12px;">Format</th>
                  <th style="padding: 12px;">Player</th>
                  <th style="padding: 12px;">Elo</th>
                  <th style="padding: 12px;">GXE</th>
                  <th style="padding: 12px;">Glicko</th>
                  <th style="padding: 12px;">Last Updated</th>
                </tr>
              </thead>
              <tbody id="battling-leaderboard">
                <tr style="border-bottom: 1px solid #ddd;">
                  <td style="padding: 12px;">1</td>
                  <td style="padding: 12px;">Loading leaderboard data...</td>
                  <td style="padding: 12px;">-</td>
                  <td style="padding: 12px;">-</td>
                  <td style="padding: 12px;">-</td>
                  <td style="padding: 12px;">-</td>
                  <td style="padding: 12px;">-</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Speedrunning Tab -->
      <div id="speedrunning-tab" class="tab-content active">
        <h3>Track 2: RPG Speedrunning</h3>
      <div class="card">
        <div style="max-height: 300px; overflow-y: auto;">
          <table style="width: 100%; border-collapse: collapse;">
            <thead style="position: sticky; top: 0; background-color: white; z-index: 1;">
              <tr style="border-bottom: 2px solid #ddd; text-align: left;">
                <th style="padding: 12px;">Rank</th>
                <th style="padding: 12px;">Team</th>
                <th style="padding: 12px;">Completion %</th>
                <th style="padding: 12px;">Time (min)</th>
                <th style="padding: 12px;">Video</th>
                <th style="padding: 12px;">Last Updated</th>
              </tr>
            </thead>
            <tbody id="speedrunning-leaderboard">
              <tr style="border-bottom: 1px solid #ddd;">
                <td style="padding: 12px;">1</td>
                <td style="padding: 12px;">Loading leaderboard data...</td>
                <td style="padding: 12px;">-</td>
                <td style="padding: 12px;">-</td>
                <td style="padding: 12px;">-</td>
                <td style="padding: 12px;">-</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

      
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-container">
        <div class="footer-column">
          <h3>PokéAgent Challenge</h3>
          <p>A NeurIPS 2025 competition advancing AI decision-making through the complex environments of Pokémon battles and gameplay.</p>
          <div class="social-links mt-1">
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-github"></i></a>
                                    <a href="https://discord.gg/E2DuX5FWF7"><i class="fab fa-discord"></i></a>
            <a href="#"><i class="fab fa-youtube"></i></a>
          </div>
        </div>
        <div class="footer-column">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="track1.html">Track 1</a></li>
            <li><a href="track2.html">Track 2</a></li>
            <li><a href="leaderboard.html">Leaderboard</a></li>
            <li><a href="rules.html">Rules</a></li>
            <li><a href="faq.html">FAQ</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h3>Contact</h3>
          <p>For questions or support, please contact:</p>
          <p>Email: pokeagentchallenge@gmail.com</p>
          <p>Join our Discord community for direct assistance and discussions.</p>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2025 PokéAgent Challenge. All rights reserved. NeurIPS 2025 Competition Track.</p>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    const mobileToggle = document.querySelector('.mobile-toggle');
    const navMenu = document.querySelector('.nav-menu');

    mobileToggle.addEventListener('click', () => {
      navMenu.classList.toggle('active');
    });

    const navLinks = document.querySelectorAll('.nav-menu a');
    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        navMenu.classList.remove('active');
      });
    });

    // Global variables for leaderboard data
    let speedrunningData = [];
    let battlingData = [];

    // Tab switching function
    // function switchTab(tabName) {
    //   // Update tab buttons
    //   document.querySelectorAll('.tab-button').forEach(button => {
    //     button.classList.remove('active');
    //   });
    //   document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
      
    //   // Update tab content
    //   document.querySelectorAll('.tab-content').forEach(content => {
    //     content.classList.remove('active');
    //   });
    //   document.getElementById(`${tabName}-tab`).classList.add('active');
    // }

    // Filter battling leaderboard by format
    function filterBattlingLeaderboard() {
      const formatSelect = document.getElementById('format-select');
      const selectedFormat = formatSelect.value;
      
      const tableBody = document.getElementById("battling-leaderboard");
      tableBody.innerHTML = '';
      
      let filteredData = battlingData;
      if (selectedFormat !== 'all') {
        filteredData = battlingData.filter(entry => entry.format === selectedFormat);
        // Limit to top 100 for individual format
        filteredData = filteredData.slice(0, 100);
      } else {
        // For "all formats", show top 100 from each format
        const top100PerFormat = {};
        battlingData.forEach(entry => {
          if (!top100PerFormat[entry.format]) {
            top100PerFormat[entry.format] = [];
          }
          if (top100PerFormat[entry.format].length < 100) {
            top100PerFormat[entry.format].push(entry);
          }
        });
        
        // Combine all formats and sort
        filteredData = [];
        Object.values(top100PerFormat).forEach(formatData => {
          filteredData.push(...formatData);
        });
      }
      
      // Sort by format, then by Elo (decreasing), then by name
    //   filteredData.sort((a, b) => {
    //     if (a.format !== b.format) {
    //       return a.format.localeCompare(b.format);
    //     }
    //     // Sort by Elo (decreasing)
    //     if (a.elo !== b.elo) {
    //       return b.elo - a.elo;
    //     }
    //     // If Elo is the same, sort by name (decreasing)
    //     return b.username.localeCompare(a.username);
    //   });
      
      filteredData.forEach((entry, index) => {
        const timestamp = new Date(entry.timestamp).toLocaleDateString();
        const row = `<tr style="border-bottom: 1px solid #ddd;">
          <td style="padding: 12px;">${entry.rank}</td>
          <td style="padding: 12px;">${entry.format}</td>
          <td style="padding: 12px;">${entry.username}</td>
          <td style="padding: 12px;">${entry.elo}</td>
          <td style="padding: 12px;">${entry.gxe}%</td>
          <td style="padding: 12px;">${entry.glicko}</td>
          <td style="padding: 12px;">${timestamp}</td>
        </tr>`;
        tableBody.innerHTML += row;
      });
    }

    // Load speedrunning leaderboard data
    fetch("leaderboard/speedrunning.json")
      .then(res => {
        if (!res.ok) throw new Error("Failed to load speedrunning leaderboard");
        return res.json();
      })
      .then(data => {
        speedrunningData = data;
        const tableBody = document.getElementById("speedrunning-leaderboard");
        tableBody.innerHTML = ''; // Clear loading message
        
        // Show all entries (up to 256) but display in scrollable area
        const allEntries = data.slice(0, 100);
        
        allEntries.forEach((entry, index) => {
          const timestamp = new Date(entry.timestamp).toLocaleDateString();
          const row = `<tr style="border-bottom: 1px solid #ddd;">
            <td style="padding: 12px;">${index + 1}</td>
            <td style="padding: 12px;">${entry.team}</td>
            <td style="padding: 12px;">${entry.completion_percent.toFixed(1)}%</td>
            <td style="padding: 12px;">${entry.runtime}</td>
            <td style="padding: 12px;"><a href="${entry.video}" target="_blank" style="color: #007bff; text-decoration: none;">Watch</a></td>
            <td style="padding: 12px;">${timestamp}</td>
          </tr>`;
          tableBody.innerHTML += row;
        });
      })
      .catch(err => {
        console.error("Error loading speedrunning leaderboard:", err);
        const tableBody = document.getElementById("speedrunning-leaderboard");
        tableBody.innerHTML = `<tr style="border-bottom: 1px solid #ddd;">
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">Error loading speedrunning leaderboard data</td>
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">-</td>
        </tr>`;
      });

    // Load battling leaderboard data
    fetch("leaderboard/battling.json")
      .then(res => {
        if (!res.ok) throw new Error("Failed to load battling leaderboard");
        return res.json();
      })
      .then(data => {
        battlingData = data;
        filterBattlingLeaderboard(); // Initial load
      })
      .catch(err => {
        console.error("Error loading battling leaderboard:", err);
        const tableBody = document.getElementById("battling-leaderboard");
        tableBody.innerHTML = `<tr style="border-bottom: 1px solid #ddd;">
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">Error loading battling leaderboard data</td>
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">-</td>
          <td style="padding: 12px;">-</td>
        </tr>`;
      });
  </script>
</body>
</html>
